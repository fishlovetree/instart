@using Instart.Models
@using Instart.Web2.Infrastructures
@model Instart.Models.AboutInstart

@{
    ViewBag.Title = "关于一沙";
    Layout = "~/Areas/Manage/Views/Shared/_Layout.cshtml";
}

<div class="row">
    @Html.Partial("PartialOther")
    <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main" style="padding-top:75px;">
        <ol class="breadcrumb">
            <li><a href="/manage/about">关于一沙</a></li>
        </ol>

        @using (Html.BeginForm("Set", "About", new
        {
            area = "Manage"
        }, FormMethod.Post, new
        {
            enctype = "multipart/form-data",
            id = "mainForm",
            @class = "form-horizontal edit-container-width"
        }))
        {
            <div class="form-group">
                <label class="col-sm-3 control-label">视频封面：</label>
                <div class="col-sm-9">
                    <img src="@Model.ImgUrl" id="imgPreview" style="width:80%;height:100px;border:1px solid #eee;" />
                    <input type="hidden" name="ImgUrl" value="@Model.ImgUrl" />
                    <a href="javascript:void(0)" onclick="$('#fileImg').click()" class="btn-link" style="position:relative;top:40px;">点击上传</a>
                    <input type='file' id='fileImg' name='fileImg' style='display:none;'>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label">团队视频：</label>
                <div class="col-sm-9">
                    @if (!String.IsNullOrEmpty(Model.VideoUrl))
                    {
                        <a class="video-play" style="float:right; margin-right: 25px;" href="javascript:void(0)" data-video="@Model.VideoUrl">播放</a>
                    }
                    <input type="hidden" name="VideoUrl" value="@Model.VideoUrl" />
                    <input type='file' id='fileVideo' name='fileVideo'>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label">Instart简介：</label>
                <div class="col-sm-9">
                    <textarea name="Introduce" id="Introduce" rows="15">@Model.Introduce</textarea>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label">Instart团队：</label>
                <div class="col-sm-9">
                    <textarea name="Team" id="Team" rows="15">@Model.Team</textarea>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label">Instart发展：</label>
                <div class="col-sm-9">
                    <textarea name="Develop" id="Develop" rows="15">@Model.Develop</textarea>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label">跨学科教学：</label>
                <div class="col-sm-9">
                    <textarea name="PassLearning" id="PassLearning" rows="10">@Model.PassLearning</textarea>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label">PreToPro封面：</label>
                <div class="col-sm-9">
                    <img src="@Model.PreToProImg" id="preToProPreview" style="width:80%;height:100px;border:1px solid #eee;" />
                    <input type="hidden" name="PreToProImg" value="@Model.PreToProImg" />
                    <a href="javascript:void(0)" onclick="$('#filePreToPro').click()" class="btn-link" style="position:relative;top:40px;">点击上传</a>
                    <input type='file' id='filePreToPro' name='filePreToPro' style='display:none;'>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label">学部制度封面：</label>
                <div class="col-sm-9">
                    <img src="@Model.DivisionImg" id="divisionPreview" style="width:80%;height:100px;border:1px solid #eee;" />
                    <input type="hidden" name="DivisionImg" value="@Model.DivisionImg" />
                    <a href="javascript:void(0)" onclick="$('#fileDivision').click()" class="btn-link" style="position:relative;top:40px;">点击上传</a>
                    <input type='file' id='fileDivision' name='fileDivision' style='display:none;'>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label">跨学科教学封面：</label>
                <div class="col-sm-9">
                    <img src="@Model.PassLearningImg" id="passLearningPreview" style="width:80%;height:100px;border:1px solid #eee;" />
                    <input type="hidden" name="PassLearningImg" value="@Model.PassLearningImg" />
                    <a href="javascript:void(0)" onclick="$('#filePassLearning').click()" class="btn-link" style="position:relative;top:40px;">点击上传</a>
                    <input type='file' id='filePassLearning' name='filePassLearning' style='display:none;'>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label">WorkShop封面：</label>
                <div class="col-sm-9">
                    <img src="@Model.WorkShopImg" id="workshopPreview" style="width:80%;height:100px;border:1px solid #eee;" />
                    <input type="hidden" name="WorkShopImg" value="@Model.WorkShopImg" />
                    <a href="javascript:void(0)" onclick="$('#fileWorkShop').click()" class="btn-link" style="position:relative;top:40px;">点击上传</a>
                    <input type='file' id='fileWorkShop' name='fileWorkShop' style='display:none;'>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label">24小时工作室封面：</label>
                <div class="col-sm-9">
                    <img src="@Model.StudioImg" id="studioPreview" style="width:80%;height:100px;border:1px solid #eee;" />
                    <input type="hidden" name="StudioImg" value="@Model.StudioImg" />
                    <a href="javascript:void(0)" onclick="$('#fileStudio').click()" class="btn-link" style="position:relative;top:40px;">点击上传</a>
                    <input type='file' id='fileStudio' name='fileStudio' style='display:none;'>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label">实习推荐封面：</label>
                <div class="col-sm-9">
                    <img src="@Model.CompanyImg" id="companyPreview" style="width:80%;height:100px;border:1px solid #eee;" />
                    <input type="hidden" name="CompanyImg" value="@Model.CompanyImg" />
                    <a href="javascript:void(0)" onclick="$('#fileCompany').click()" class="btn-link" style="position:relative;top:40px;">点击上传</a>
                    <input type='file' id='fileCompany' name='fileCompany' style='display:none;'>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label">艺术家孵化平台封面：</label>
                <div class="col-sm-9">
                    <img src="@Model.ActorImg" id="actorPreview" style="width:80%;height:100px;border:1px solid #eee;" />
                    <input type="hidden" name="ActorImg" value="@Model.ActorImg" />
                    <a href="javascript:void(0)" onclick="$('#fileActor').click()" class="btn-link" style="position:relative;top:40px;">点击上传</a>
                    <input type='file' id='fileActor' name='fileActor' style='display:none;'>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label">驻地项目封面：</label>
                <div class="col-sm-9">
                    <img src="@Model.ProgramsImg" id="programsPreview" style="width:80%;height:100px;border:1px solid #eee;" />
                    <input type="hidden" name="ProgramsImg" value="@Model.ProgramsImg" />
                    <a href="javascript:void(0)" onclick="$('#filePrograms').click()" class="btn-link" style="position:relative;top:40px;">点击上传</a>
                    <input type='file' id='filePrograms' name='filePrograms' style='display:none;'>
                </div>
            </div>

            <div class="form-group">
                <div class="col-sm-offset-3 col-sm-10">
                    <input type="button" class="btn btn-primary" value="保存" onclick="save()" />
                </div>
            </div>
        }
        <div id="videoModal" class="modal fade" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title">视频预览</h4>
                    </div>
                    <div class="modal-body">
                        <video class="video-container" src="/i/movie.ogg" style="width:100%;height:400px;" controls="controls"></video>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Bottom{
    <script>
        $(function () {
            UE.getEditor('Introduce');

            UE.getEditor('Team');

            UE.getEditor('Develop');

            UE.getEditor('PassLearning');

            $('#fileImg').change(function () {
                imagePreview(this.files[0], $("#imgPreview"));
            });

            $(".video-play").click(function () {
                var src = $(this).attr("data-video");
                if (src == "") {
                    layer.msg("视频地址为空");
                    return;
                }

                $(".video-container").attr("src", src);
                $("#videoModal").modal("show");
            });

            $('#filePreToPro').change(function () {
                imagePreview(this.files[0], $("#preToProPreview"));
            });

            $('#fileDivision').change(function () {
                imagePreview(this.files[0], $("#divisionPreview"));
            });

            $('#filePassLearning').change(function () {
                imagePreview(this.files[0], $("#passLearningPreview"));
            });

            $('#fileWorkShop').change(function () {
                imagePreview(this.files[0], $("#workShopPreview"));
            });

            $('#fileStudio').change(function () {
                imagePreview(this.files[0], $("#studioPreview"));
            });

            $('#fileCompany').change(function () {
                imagePreview(this.files[0], $("#companyPreview"));
            });

            $('#fileActor').change(function () {
                imagePreview(this.files[0], $("#actorPreview"));
            });

            $('#filePrograms').change(function () {
                imagePreview(this.files[0], $("#programsPreview"));
            });
        })

        function save() {
            $("#mainForm").ajaxSubmit({
                success: function (slt) {
                    if (slt && slt.success) {
                        layer.msg('保存成功');
                    }
                    else {
                        layer.msg(slt.message || '操作失败，请重试');
                    }
                }
            });
        }

    </script>
}