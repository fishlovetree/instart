@using Instart.Models
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<!--banner展示图-->
<div class="banner">
    <ul class="lubo_box">
        @foreach (Banner item in ViewBag.BannerList)
        {
            if (item.Type == Instart.Models.Enums.EnumBannerType.Image)
            {
                <li><a style="background:url(@item.ImageUrl) center top no-repeat"></a></li>
            }
            else if (item.Type == Instart.Models.Enums.EnumBannerType.Video)
            {
                <li style=" opacity: 1;filter:alpha(opacity=100);">
                    <a href="" style="background:url(@item.ImageUrl) center top no-repeat">
                        <video autoplay="autoplay" muted="muted" loop="loop" poster="@item.ImageUrl" title="">
                            <source class="video--mp4" src="@item.VideoUrl" type="video/mp4">
                        </video>
                    </a>
                </li>
            }
        }
    </ul>
</div>

<!--院校搜索-->
<div class="maincont" id="maincont">
    <div class="coll-search">
        <h2>院校搜索</h2>
        <div class="soso">
            <input type="text" placeholder="院校名称" class="soinput" name="keyword" id="keyword" />
            <button type="button" class="sobutton" onclick="search()">搜索</button>
        </div>
        <div class="hotsearch">
            <span>热门搜索：</span>
            @foreach (School item in ViewBag.HotList)
            {
                <a href="/school/details/@item.Id">@item.Name</a>
            }
        </div>
    </div>
    <!--条件搜索-->
    <div class="conditie">
        <dl>
            <dt>国家：</dt>
            <dd>
                <a href="#" onclick="searchCountry(-1)">全部</a><a href="#" onclick="searchCountry(0)">英国</a><a href="#" onclick="searchCountry(1)">美国</a>
                <a href="#" onclick="searchCountry(2)">欧洲</a><a href="#" onclick="searchCountry(3)">亚洲</a><a href="#" onclick="searchCountry(9)">其他</a>
            </dd>
        </dl>
        <dl>
            <dt>学历：</dt>
            <dd><a href="#">全部</a><a href="#">本科</a><a href="#">硕士</a></dd>
        </dl>
        <dl>
            <dt>专业：</dt>
            <dd><a href="#">全部</a><a href="#">室内设计</a><a href="#">服装设计</a><a href="#">建筑设计</a><a href="#">平面设计</a><a href="#">工业设计</a><a href="#">纯艺术类</a></dd>
        </dl>
    </div>
    <!--院校情况-->
    <div class="school com-cont noborder">
    </div>
    <div class="pagelist pagenum">
    </div>
    <!--课程推荐-->
    <div class="title">
        <h2>课程推荐</h2>
        <a href="#" class="more">查看全部&gt;&gt;</a>
    </div>
    <div class="recommend com-cont">
        <ul>
            @foreach (Course item in ViewBag.CourseList)
            {
                <li>
                    <div class="recimg">
                        <a href="#">
                            <i></i>
                            <p>@item.Introduce</p>
                            <img src="@item.Picture" alt="@item.Name" />
                        </a>
                    </div>
                </li>
            }
        </ul>
    </div>
</div>
@section Bottom{
    <script type="text/javascript">
        $(function () {
            getData(1);
            $('.pagelist').on('click', 'li a', function () {
                var rel = $(this).attr("rel");
                if (rel) {
                    getData(rel);
                }
            });
        });

        function getData(page, keyword, country, major) {
            $.ajax({
                url: '/school/getschoollist',
                type: 'POST',
                data: { pageIndex: page, keyword: keyword, country: country, major: major },
                success: function (slt) {
                    var html = '<ul>';
                    if (slt.data.list != null) {
                        for (var index in slt.data.list) {
                            var item = slt.data.list[index];
                            html += '<li><div class="school-cont">';
                            html += '<div class="top"><a href="#"><i></i><img src="' + item.Avatar + '" alt="" /></a></div>';
                            html += '<div class="s-name"><div class="s-name-left"><dl>';
                            html += '<dt>' + item.Name + '</dt><dd>' + item.NameEn + '</dd><p><span class="glaxfont">申请难度：</span>' + item.Difficult + '</p>';
                            html += '<p><span class="glaxfont">录取比例：</span>' + item.AcceptRate + '"%"</p></dl></div>';
                            html += '<div class="s-name-right"><a href="#"><img src="' + item.Logo + '" alt="" /></a></div></div>';
                            html += '<div class="yuanxiao">';
                            html += '<p><i class="glaxfont">留学预算:</i>' + item.Fee + '</span><span><i class="glaxfont">平均奖学金:</i>' + item.Scholarship + '</span></p>';
                            html += '<p><span><i class="glaxfont">申请截止日期:</i> 早申: 11月11日</span><span>常规: 11月11日</span></p>';
                            html += '<p><span><i class="glaxfont">语言要求:</i> 本科: 托福92 / 雅思7.0<span><span>硕士: 托福92 / 雅思7.0</span></p>';
                            html += '<p><span><i class="glaxfont">优势专业:</i> ' + item.RecommendMajor + '</span></p>';
                            html += '<div class="morea"><a href="/school/details/' + item.Id + '">院校详情</a></div>';
                            html += '</div>';
                            html += '</div></li>';
                        }
                    }
                    html += '</ul>';
                    $('.school').html(html);
                    getPageBar(page, slt.data.totalPage, $('.pagelist'));
                },
                error: function () {
                    layer.msg("数据加载失败。");
                }
            });
        }

        function search() {
            var keyword = $("#keyword").val();
            getData(1, keyword);
        }

        function searchCountry(country){
            var keyword = $("#keyword").val();
            getData(1, keyword, country);
        }
    </script>
}

